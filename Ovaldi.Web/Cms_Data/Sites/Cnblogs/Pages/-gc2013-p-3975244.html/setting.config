<?xml version="1.0" encoding="utf-8"?>
<Page xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/Ovaldi.Core.Models">
	<AbsoluteName>-gc2013-p-3975244.html</AbsoluteName>
	<CustomFields xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
	<EnableScript>true</EnableScript>
	<EnableTheming>true</EnableTheming>
	<Html>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;C# 利用WORD模板和标签（bookmark） 批量生成WORD - GC2013 - 博客园&lt;/title&gt;
&lt;link type="text/css" rel="stylesheet" href="/preview~Cnblogs/Styles/bundles/blog-common.css"&gt;
&lt;link id="MainCss" type="text/css" rel="stylesheet" href="/preview~Cnblogs/Styles/skins/ClearScreen01/bundle-ClearScreen01.css"&gt;
&lt;link type="text/css" rel="stylesheet" href="/preview~Cnblogs/Styles/blog/customcss/170144.css"&gt;
&lt;link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/gc2013/rss"&gt;
&lt;link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/gc2013/rsd.xml"&gt;
&lt;link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/gc2013/wlwmanifest.xml"&gt;
&lt;script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"&gt;&lt;/script&gt;  
&lt;script type="text/javascript"&gt;var currentBlogApp = 'gc2013', cb_enable_mathjax=false;&lt;/script&gt;
&lt;script src="/preview~Cnblogs/Scripts/bundles/blog-common.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;a name="top"&gt;&lt;/a&gt;
&lt;div id="page_begin_html"&gt;&lt;/div&gt;&lt;script&gt;load_page_begin_html();&lt;/script&gt;

&lt;!--done--&gt;
&lt;div id="header"&gt;
	
&lt;!--done--&gt;
&lt;div class="header"&gt;
	&lt;div class="headerText"&gt;
		&lt;a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/gc2013/"&gt;GC2013&lt;/a&gt;&lt;br&gt;
		
	&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div id="mylinks"&gt;
&lt;!--done--&gt;
&lt;a id="MyLinks1_HomeLink" class="listitem" href="http://www.cnblogs.com/"&gt;博客园&lt;/a&gt;&amp;nbsp;&amp;nbsp;::&amp;nbsp;
&lt;a id="MyLinks1_MyHomeLink" class="listitem" href="http://www.cnblogs.com/gc2013/"&gt;首页&lt;/a&gt;&amp;nbsp;&amp;nbsp;::&amp;nbsp;
&lt;a id="MyLinks1_NewPostLink" class="listitem" rel="nofollow" href="http://i.cnblogs.com/EditPosts.aspx?opt=1"&gt;新随笔&lt;/a&gt;&amp;nbsp;&amp;nbsp;::&amp;nbsp;
&lt;a id="MyLinks1_ContactLink" accesskey="9" class="listitem" rel="nofollow" href="http://space.cnblogs.com/msg/send/GC2013"&gt;联系&lt;/a&gt;&amp;nbsp;&amp;nbsp;::&amp;nbsp;
&lt;a id="MyLinks1_Syndication" class="listitem" href="http://www.cnblogs.com/gc2013/rss"&gt;订阅&lt;/a&gt;&amp;nbsp;&lt;a id="MyLinks1_XMLLink" href="http://www.cnblogs.com/gc2013/rss"&gt;&lt;img src="/preview~Cnblogs/Images/images/xml.gif" alt="订阅"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;::&amp;nbsp;
&lt;a id="MyLinks1_Admin" class="listitem" rel="nofollow" href="http://i.cnblogs.com/"&gt;管理&lt;/a&gt;
&lt;/div&gt;
&lt;div id="mytopmenu"&gt;
	
		&lt;div id="mystats"&gt;
			
&lt;!--done--&gt;
&lt;div class="blogStats"&gt;
posts - 279,&amp;nbsp;
comments - 141,&amp;nbsp;
trackbacks - 0

&lt;/div&gt;&lt;/div&gt;
	
&lt;/div&gt;
&lt;div id="leftcontent"&gt;
	
		&lt;div id="leftcontentcontainer"&gt;
			
&lt;!--done--&gt;
&lt;div class="news"&gt;公告&lt;/div&gt;
	&lt;div class="newsItem"&gt;
		&lt;div id="blog-news"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;loadBlogNews();&lt;/script&gt;
	&lt;/div&gt;

			&lt;div id="blog-calendar" style="display:none"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;loadBlogDefaultCalendar();&lt;/script&gt;
			&lt;div id="blog-sidecolumn"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;loadBlogSideColumn();&lt;/script&gt;&lt;/div&gt;
	
&lt;/div&gt;
&lt;div id="centercontent"&gt;
	

&lt;!--done--&gt;
&lt;div class="post"&gt;
	&lt;div class="postTitle"&gt;
		&lt;a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/gc2013/p/3975244.html"&gt;C# 利用WORD模板和标签（bookmark） 批量生成WORD&lt;/a&gt;
	&lt;/div&gt;
	&lt;div id="cnblogs_post_body"&gt;&lt;p&gt;前言：&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'Microsoft YaHei'; font-size: 12px;"&gt;由于对C#操作WORD不熟悉，也就留下这么一篇水文，别吐糟...=_=|||&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;利用Microsoft.Office.Interop.Word (2003版也就11版)&amp;mdash;&amp;mdash;因为部分客户端还是用Office2003，所以保险起见应该引入低一点的版本&lt;/p&gt;
&lt;p&gt;我的需求很简单，从DataTable里面循环取数据批量生成Word文档，解决方案是利用Word模板.dot插入书签并保存为程序使用的模板，&lt;/p&gt;
&lt;p&gt;用C#打开word模板修改书签的值并批量生成Word.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'Microsoft YaHei'; font-size: 12px;"&gt;遇到的问题：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'Microsoft YaHei'; font-size: 12px;"&gt;我的思路是打开模板，然后循环修改书签内容，每循环一次生成一个.doc，实际上遇到的问题是当第二次给书签赋值(比如bookMark.Range.Text="2013-4-24")发现是+=的操作，也就是循环第二次书签的值是"2013-4-242013-4-24"，我的理解是因为模板没有关闭，所以对书签实际上是进行了两次【插入】的操作，而非我们理解的【赋值】，一个可以实现的做法是先关闭dot再打开重新进行一次赋值，但是由于耗时超长所以我毫不犹豫抛弃这种做法，平均下来几乎一秒钟才生成一个WORD，当然Win764bit效率要低一点。&amp;mdash;&amp;mdash;因为我后来才发现生成的软件在32bit 的xp运行效率比62bit 的WIN7高不少，而我在虚拟机运行的效率竟然比32bit 的宿主xp更快，可能虚拟机只装了office2003和framework2.0的缘故，即便如此，在xp下效率还是很低。问题回到如何不关闭模板文件的情况下，循环插入生成WORD。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;解决方案：&lt;/p&gt;
&lt;div class="dp-highlighter bg_csharp" style="font: 12px/26px Consolas, 'Courier New', Courier, mono, serif; margin: 18px 0px !important; width: 700.9px; text-align: left; color: #333333; text-transform: none; text-indent: 0px; letter-spacing: normal; overflow: auto; padding-top: 1px; word-spacing: 0px; white-space: normal; font-size-adjust: none; font-stretch: normal; background-color: #e7e5dc; -webkit-text-stroke-width: 0px;"&gt;
&lt;div class="bar"&gt;
&lt;div class="tools"&gt;&lt;strong&gt;[csharp]&lt;/strong&gt;&lt;span class="Apple-converted-space"&gt;&lt;span class="Apple-converted-space"&gt;&amp;nbsp;&lt;a class="ViewSource" style="background-position: 0% 0%; margin: 0px 10px 0px 0px; padding: 1px; border: currentColor; width: 16px; height: 16px; color: #a0a0a0; text-indent: -2000px; font-size: 9px; text-decoration: none; display: inline-block; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_plain.gif'); background-repeat: no-repeat no-repeat; background-color: inherit;" title="view plain" onclick="dp.sh.Toolbar.Command('ViewSource',this);return false;" href="http://blog.csdn.net/lin437922751/article/details/8846249"&gt;view plain&lt;/a&gt;&lt;a class="CopyToClipboard" style="background-position: 0% 0%; margin: 0px 10px 0px 0px; padding: 1px; border: currentColor; width: 16px; height: 16px; color: #a0a0a0; text-indent: -2000px; font-size: 9px; text-decoration: none; display: inline-block; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/default/ico_copy.gif'); background-repeat: no-repeat no-repeat; background-color: inherit;" title="copy" onclick="dp.sh.Toolbar.Command('CopyToClipboard',this);return false;" href="http://blog.csdn.net/lin437922751/article/details/8846249"&gt;copy&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;
&lt;div&gt;&lt;object id="ZeroClipboardMovie_1" width="18" height="18" align="middle" bgcolor="#ffffff" data="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" type="application/x-shockwave-flash"&gt;&lt;param name="src" value="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf"&gt;&lt;param name="pluginspage" value="http://www.macromedia.com/go/getflashplayer"&gt;&lt;param name="loop" value="loop"&gt;&lt;param name="menu" value="false"&gt;&lt;param name="quality" value="best"&gt;&lt;param name="allowscriptaccess" value="always"&gt;&lt;param name="allowfullscreen" value="false"&gt;&lt;param name="flashvars" value="id=1&amp;amp;width=18&amp;amp;height=18"&gt;&lt;param name="wmode" value="transparent"&gt;&lt;/object&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;ol class="dp-c" start="1"&gt;
&lt;li class="alt"&gt;&lt;span class="keyword"&gt;object[]&amp;nbsp;oBookMark&amp;nbsp;=&amp;nbsp;&lt;span class="keyword"&gt;new&amp;nbsp;&lt;span class="keyword"&gt;object[8];&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;oBookMark[0]&amp;nbsp;=&amp;nbsp;&lt;span class="string"&gt;"Date";&lt;span class="comment"&gt;//省略赋值&amp;nbsp;&amp;nbsp;用来记录书签名称&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Word.Range[]&amp;nbsp;rng&amp;nbsp;=&amp;nbsp;&lt;span class="keyword"&gt;new&amp;nbsp;Word.Range[8];&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span class="keyword"&gt;string[]&amp;nbsp;bookMarkName&amp;nbsp;=&amp;nbsp;&lt;span class="keyword"&gt;new&amp;nbsp;&lt;span class="keyword"&gt;string[8];&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span class="keyword"&gt;for&amp;nbsp;(&lt;span class="keyword"&gt;int&amp;nbsp;i&amp;nbsp;=&amp;nbsp;0;&amp;nbsp;i&amp;nbsp;&amp;lt;&amp;nbsp;8;&amp;nbsp;i++)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;rng[i]&amp;nbsp;=&amp;nbsp;oDoc.Bookmarks.get_Item(&lt;span class="keyword"&gt;ref&amp;nbsp;oBookMark[i]).Range;&lt;span class="comment"&gt;//获取书签对象赋值给我们已经定义的数组用来下面循环体的插入&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bookMarkName[i]&amp;nbsp;=&amp;nbsp;oDoc.Bookmarks.get_Item(&lt;span class="keyword"&gt;ref&amp;nbsp;oBookMark[i]).Name;&lt;span class="comment"&gt;//获取书签名称好书签对象赋值给我已经定义好的rng和oBookMark&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li class="alt"&gt;&lt;span class="comment"&gt;//循环体&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&lt;span class="keyword"&gt;for&amp;nbsp;(&lt;span class="keyword"&gt;int&amp;nbsp;i&amp;nbsp;=&amp;nbsp;dt.Rows.Count-1;&amp;nbsp;i&amp;nbsp;&amp;gt;=&amp;nbsp;0;&amp;nbsp;i--)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;rng[0].Text&amp;nbsp;=&amp;nbsp;dt.Rows[i][&lt;span class="string"&gt;"日期"].ToString();&lt;span class="comment"&gt;//赋值多个书签0~8&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span class="keyword"&gt;for&amp;nbsp;(&lt;span class="keyword"&gt;int&amp;nbsp;j&amp;nbsp;=&amp;nbsp;0;&amp;nbsp;j&amp;nbsp;&amp;lt;&amp;nbsp;8;&amp;nbsp;j++)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;oDoc.Bookmarks.Add(bookMarkName[j],&amp;nbsp;rng[j]);&lt;span class="comment"&gt;//此处直接插入即可，替代了原来的书签，位置不变...囧&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span class="comment"&gt;//也就是说Add操作实际上并不是随意插入书签，而是替代了原有书签，这样子每次就可以重新赋值了&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;li&gt;&lt;span class="comment"&gt;//这里保存oDoc&amp;nbsp;用Save方法&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;
&lt;li class="alt"&gt;}&amp;nbsp;&amp;nbsp;&lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font: 12px/26px 'Microsoft YaHei'; text-align: left; color: #333333; text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; font-size-adjust: none; font-stretch: normal; background-color: #ffffff; -webkit-text-stroke-width: 0px;"&gt;&lt;span style="font: 12px/26px 'Microsoft YaHei'; text-align: left; color: #333333; text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; font-size-adjust: none; font-stretch: normal; background-color: #ffffff; -webkit-text-stroke-width: 0px;"&gt;思路获取书签对象和书签名称赋值给我们已经定义的oBook和rng，然后做一个插入的操作，而非修改文档本身的书签值&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'Microsoft YaHei'; font-size: 12px;"&gt;这个方法跟刚刚搜到的文章《如何利用书签向word文档读取或写入数据[C#]》提及的&amp;ldquo;由于附值以后书签自动消除，为了以后便于修改，需要把书签再自动生成一个&amp;rdquo;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'Microsoft YaHei'; font-size: 12px;"&gt;似乎是一样的实现，也懒得细想，另外我还利用Selection.InsertFile方法把生成的文档合并为一个文件（由于这个方法只能附加文件而不能从doc对象中提取页面进行附加，所以又有了大量的打开Word操作，两个Word.exe在后台进行，看着也蛋疼，果不其然的使程序更加耗时间），但是一个文件多个页面还是比多个单页的文档讨人喜欢。还是欢迎吐糟吧。。=_=||||&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;div id="MySignature"&gt;&lt;/div&gt;
&lt;div class="clear"&gt;&lt;/div&gt;
&lt;div id="blog_post_info_block"&gt;
&lt;div id="BlogPostCategory"&gt;&lt;/div&gt;
&lt;div id="EntryTag"&gt;&lt;/div&gt;
&lt;div id="blog_post_info"&gt;
&lt;/div&gt;
&lt;div class="clear"&gt;&lt;/div&gt;
&lt;div id="post_next_prev"&gt;&lt;/div&gt;
&lt;/div&gt;


	&lt;div class="postDesc"&gt;posted on &lt;span id="post-date"&gt;2014-09-16 16:42&lt;/span&gt; &lt;a href='http://www.cnblogs.com/gc2013/'&gt;GC2013&lt;/a&gt; 阅读(&lt;span id="post_view_count"&gt;...&lt;/span&gt;) 评论(&lt;span id="post_comment_count"&gt;...&lt;/span&gt;)  &lt;a href="http://i.cnblogs.com/EditPosts.aspx?postid=3975244" rel="nofollow"&gt;编辑&lt;/a&gt; &lt;a href="#" onclick="AddToWz(3975244);return false;"&gt;收藏&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;var allowComments=true,isLogined=false,cb_blogId=170144,cb_entryId=3975244,cb_blogApp=currentBlogApp,cb_blogUserGuid='91e05b31-7257-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2014/9/16 16:42:00';loadViewCount(cb_entryId);&lt;/script&gt;

&lt;a name="!comments"&gt;&lt;/a&gt;&lt;div id="blog-comments-placeholder"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;var commentManager = new blogCommentManager();commentManager.renderComments(0);&lt;/script&gt;
&lt;div id="comment_form" class="commentform"&gt;
&lt;a name="commentform"&gt;&lt;/a&gt;
&lt;div id="divCommentShow"&gt;&lt;/div&gt;
&lt;div id="comment_nav"&gt;&lt;span id="span_refresh_tips"&gt;&lt;/span&gt;&lt;a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();"&gt;刷新评论&lt;/a&gt;&lt;a href="#" onclick="return RefreshPage();"&gt;刷新页面&lt;/a&gt;&lt;a href="#top"&gt;返回顶部&lt;/a&gt;&lt;/div&gt;
&lt;div id="comment_form_container"&gt;&lt;/div&gt;
&lt;div class="ad_text_commentbox" id="ad_text_under_commentbox"&gt;&lt;/div&gt;
&lt;div id="site_nav_under"&gt;&lt;a href="http://www.cnblogs.com/" target="_blank" title="开发者的网上家园"&gt;博客园首页&lt;/a&gt;&lt;a href="http://q.cnblogs.com/" target="_blank" title="程序员问答社区"&gt;博问&lt;/a&gt;&lt;a href="http://news.cnblogs.com/" target="_blank" title="IT新闻"&gt;新闻&lt;/a&gt;&lt;a href="http://home.cnblogs.com/ing/" target="_blank"&gt;闪存&lt;/a&gt;&lt;a href="http://job.cnblogs.com/" target="_blank"&gt;程序员招聘&lt;/a&gt;&lt;a href="http://kb.cnblogs.com/" target="_blank"&gt;知识库&lt;/a&gt;&lt;/div&gt;
&lt;div id="opt_under_post"&gt;&lt;/div&gt;
&lt;script type="text/javascript"&gt;
    var enableGoogleAd = canShowAdsense(); var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];
    fixPostBodyFormat();
&lt;/script&gt;
&lt;div id="ad_under_post_holder"&gt;
&lt;script type='text/javascript'&gt;
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    (function () {
        if (enableGoogleAd) {
            var gads = document.createElement('script');
            gads.async = true;
            gads.type = 'text/javascript';
            var useSSL = 'https:' == document.location.protocol;
            gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
            var node = document.getElementsByTagName('script')[0];
            node.parentNode.insertBefore(gads, node);
        }
    })();
&lt;/script&gt;
&lt;script type='text/javascript'&gt;
    try {
        if (enableGoogleAd) {
            googletag.cmd.push(function () {
                googletag.defineSlot('/1090369/cnblogs_blogpost_C1_sitehome', [300, 250], 'div-gpt-ad-1346480159711-0').addService(googletag.pubads());
                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
            });
        };
    } catch (e) { }
&lt;/script&gt;
&lt;div id="google_ad_c1" class="c_ad_block"&gt;
    &lt;div id='div-gpt-ad-1346480159711-0' style='width:300px; height:250px;'&gt;
    &lt;script type='text/javascript'&gt;
        try {
            if (enableGoogleAd) {
                googletag.cmd.push(function () { googletag.display('div-gpt-ad-1346480159711-0'); });            
            } else {
                $('#div-gpt-ad-1346480159711-0').hide();
            }
    } catch (e) { }
    &lt;/script&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="blog_news_kb"&gt;&lt;/div&gt;
&lt;div id="HistoryToday" class="c_ad_block"&gt;&lt;/div&gt;
&lt;script type="text/javascript"&gt;
$(function () {
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    setTimeout(function () { incrementViewCount(cb_entryId); }, 200);
});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;!--done--&gt;
&lt;div class="footer"&gt;
	Powered by: 
	&lt;br&gt;
	
	&lt;a id="Footer1_Hyperlink3" name="Hyperlink1" href="http://www.cnblogs.com/"&gt;&lt;font face="Verdana"&gt;博客园&lt;/font&gt;&lt;/a&gt;
	&lt;br&gt;
	Copyright &amp;copy;2014 GC2013
&lt;/div&gt;


&lt;!--PageEndHtml Block Begin--&gt;
&lt;script type="text/javascript"&gt;BAIDU_CLB_SLOT_ID = "953331";&lt;/script&gt;
&lt;script type="text/javascript" src="http://cbjs.baidu.com/js/o.js"&gt;&lt;/script&gt;

&lt;script type="text/javascript"&gt;
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fd7e11970fcbc0028a46aff08cffbba37' type='text/javascript'%3E%3C/script%3E"));
&lt;/script&gt;
&lt;!--PageEndHtml Block End--&gt;
&lt;/body&gt;
&lt;/html&gt;
</Html>
	<HtmlMetas i:nil="true" />
	<HtmlTitle i:nil="true" />
	<IsDefault>false</IsDefault>
	<Layout i:nil="true" />
	<Name>-gc2013-p-3975244.html</Name>
	<OutputCache i:nil="true" />
	<PageContents xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" />
	<Plugins xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
	<Published>false</Published>
	<RequireHttps>false</RequireHttps>
	<Routes>
		<PageRoute>
			<Defaults xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" />
			<Identifier>/gc2013/p/3975244.html</Identifier>
			<RoutePath i:nil="true" />
		</PageRoute>
	</Routes>
	<Scripts i:nil="true" />
	<Site>
		<AbsoluteName xmlns="Ovaldi.Core.Models">Cnblogs</AbsoluteName>
	</Site>
	<Styles i:nil="true" />
	<UUID>-gc2013-p-3975244.html</UUID>
</Page>